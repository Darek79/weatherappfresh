import Head from 'next/head';
import { Box, PageWrapper, MainApp } from 'components';
import type { IGetWeatherIndexes } from 'utils/getWeatherIndexes';

interface Data {
    indexesObj: IGetWeatherIndexes | null;
    error: string | null;
}
interface ResponseData {
    weatherObjects: Data;
}

export default function Home({ weatherObjects }: ResponseData) {
    if (weatherObjects.error) {
        console.log('error');
        return (
            <PageWrapper className="bg-pageBG flex justify-center">
                <Box className="m-auto font-bold">{weatherObjects.error}</Box>
            </PageWrapper>
        );
    }

    return (
        <PageWrapper className="bg-pageBG flex justify-center">
            <Head>
                <title>Weather APP</title>
                <meta name="description" content="Generated by create next app" />
                <link rel="icon" href="/favicon.ico" />
            </Head>
            <MainApp weatherObjects={weatherObjects.indexesObj && weatherObjects.indexesObj} />
        </PageWrapper>
    );
}
export async function getStaticProps() {
    const dayObjectsJson = await fetch('http://localhost:3000/api/getWeatherByIP');
    const weatherObjects: Data = await dayObjectsJson.json();
    return {
        props: { weatherObjects: weatherObjects },
    };
}
